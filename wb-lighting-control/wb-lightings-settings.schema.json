{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "title": "Lightings settings",
    "description": "Configuration of Lightings settings",
    "options": {
        "disable_edit_json": true,
        "disable_properties": true,
        "disable_collapse": true
    },
    "configFile": {
        "path": "/mnt/data/etc/wb-lightings-settings.conf",
        "service": "wb-rules"
    },
    "properties": {
		"astronomicalDayNightSensor": {
			"$ref": "#/definitions/astronomicalDayNightSensor",
			"propertyOrder": 10,
            "options": {
				"collapsed": true,
                "disable_edit_json": true,
				"disable_properties": true
            }
		},
		"location": {
			"$ref": "#/definitions/locationsSettings",
			"propertyOrder": 20,
            "options": {
                "disable_edit_json": true,
                "disable_collapse": true,
                "disable_properties": true
            }
		},
        "controls": {
            "type": "object",
            "options": {
                "hidden": true
            }
        }
    },
	"required": [
		"astronomicalDayNightSensor",
		"location",
		"controls"
		],
    "definitions": {
        "masterSettings": {
            "type": "object",
            "title": "Master controls",
            "propertyOrder": 20,
            "properties": {
				"masterSwitchUse": {
					"type": "boolean",
					"title": "Master switch",
					"description": "–êllows you to control subordinate light sources",
					"propertyOrder": 10,
					"_format": "checkbox"
				},
                "masterSwitchControl": {
                    "type": "string",
                    "title": "HW switch",
					"description": "Hardware switch control",
                    "propertyOrder": 20,
                    "options": {
                        "grid_columns": 2,
                        "dependencies": {
                            "masterSwitchUse": true
                        }
                    },
                    "watch": {
                        "channelsControls": "root.controls.channelsControls"
                    },
                    "enumSource": [
                        {
                            "source": "channelsControls",
                            "title": "{{item}}",
                            "value": "{{item}}"
                        }
                    ]
                }
            },
			"required": [
				"masterSwitchUse"
			],
            "options": {
                "disable_collapse": true,
                "disable_properties": true,
                "disable_edit_json": true,
                "wb": {
                    "disable_title": true
                }
            }
        },
        "locations": {
            "headerTemplate": "{{self.name}}",
            "$ref": "#/definitions/locationsSettings",
            "options": {
                "disable_edit_json": true,
                "wb": {
                    "disable_title": true
                }
            }
        },
        "locationsSettings": {
			"title": "Locations",
            "type": "object",
            "properties": {
                "id": {
                    "type": "string",
                    "propertyOrder": 10,
                    "options": {
                        "hidden": true
                    }
                },
                "name": {
                    "type": "string",
                    "title": "Name",
                    "propertyOrder": 20,
                    "options": {
                        "hidden": true,
                        "grid_columns": 6,
                        "wb": {
                            "disable_title": true
                        }
                    }
                },
                "masterSetting": {
                    "propertyOrder": 20,
                    "$ref": "#/definitions/masterSettings"
                },
                "showLocations": {
                    "type": "boolean",
                    "default": false,
                    "propertyOrder": 40,
                    "options": {
                        "hidden": true
                    }
                },
                "locations": {
                    "type": "array",
                    "title": "Sub locations",
                    "_format": "tabs",
                    "propertyOrder": 100,
                    "items": {
                        "$ref": "#/definitions/locations"
                    },
                    "options": {
                        "disable_collapse": false,
                        "disable_array_delete": true,
                        "disable_array_add": true,
                        "disable_array_reorder": true,
                        "disable_array_delete_last_row": true,
                        "disable_array_delete_all_rows": true,
                        "dependencies": {
                            "showLocations": true
                        }
                    }
                },
				"lightingSources":{
                    "propertyOrder": 200,
                    "$ref": "#/definitions/lightingSources",
                    "options": {
                        "dependencies": {
                            "showLocations": false
                        }
					}
				},
				"autoPowerOff": {
                    "type": "boolean",
					"title": "Auto power off",
                    "default": false,
                    "propertyOrder": 250,
					"_format": "checkbox",
                    "options": {
                        "dependencies": {
                            "showLocations": false
                        }
					}
				},
				"powerOffDelay": {
                    "type": "integer",
					"title": "Power off delay",
                    "default": 120,
                    "propertyOrder": 270,
                    "options": {
                        "dependencies": {
                            "autoPowerOff": true
                        }
					}
				},
				"illuminance": {
					"type": "object",
					"_format": "grid",
					"title": "Illuminance",
					"propertyOrder": 280,
					"properties": {
						"sensor": {
							"type": "string",
							"title": "Illuminance sensor",
							"propertyOrder": 100,
							"options": {
								"grid_columns": 6
							},
							"watch": {
								"illuminanceSensors": "root.controls.illuminanceSensors"
							},
							"enumSource": [
								{
									"source": "illuminanceSensors",
									"title": "{{item}}",
									"value": "{{item}}"
								}
							]
						},
						"value": {
							"type": "number",
							"title": "Value",
							"default": 100,
							"propertyOrder": 110,
							"options": {
								"grid_columns": 3
							}
						}
					},
					"options": {
						"disable_edit_json": true,
                        "disable_collapse": true,
						"disable_properties": true,
						"wb": {
							"disable_title": true,
							"disable_panel": true
						},
						"dependencies": {
							"autoPowerOff": true
						}
					},
				},
                "lightingControls": {
                    "propertyOrder": 300,
                    "$ref": "#/definitions/lightingControls",
                    "options": {
                        "dependencies": {
                            "autoPowerOff": true
                        }
					}
                }
            },
			"required": [
				"id",
				"name",
				"masterSetting",
				"showLocations"
			]
        },
        "lightingSources": {
            "_format": "table",
            "items": {
                "$ref": "#/definitions/lightingSource"
            },
            "options": {
                "grid_columns": 12,
                "array_controls_top": true,
                "disable_array_delete_last_row": true,
                "disable_array_reorder": true,
                "disable_collapse": true,
                "enable_array_copy": false,
                "wb": {
                    "disable_panel": true,
					"disable_array_item_panel" : true,
					"disable_title" : true
                }
            },
            "propertyOrder": 200,
            "headerTemplate": "Sources",
            "type": "array"
        },
        "lightingSource": {
			"title": "Source",
            "properties": {
				"source": {
                    "type": "string",
                    "title": "Source",
                    "propertyOrder": 20,
                    "options": {
                        "grid_columns": 6
                    },
                    "watch": {
                        "channelsSources": "root.controls.channelsSources"
                    },
                    "enumSource": [
                        {
                            "source": "channelsSources",
                            "title": "{{item}}",
                            "value": "{{item}}"
                        }
                    ]
				},
                "name": {
                    "type": "string",
                    "title": "Name",
                    "propertyOrder": 30,
                    "options": {
                        "grid_columns": 6
                    }
                },
                "brightness": {
                    "type": "string",
                    "title": "Brightness",
                    "propertyOrder": 40,
					"readonly": true,
                    "options": {
                        "grid_columns": 6
                    }
                }
            },
			"required": [
				"source",
				"name",
				"brightness"
			]
        },
        "lightingControls": {
            "_format": "table",
            "items": {
                "$ref": "#/definitions/lightingControl"
            },
            "options": {
                "grid_columns": 12,
                "array_controls_top": true,
                "disable_array_delete_last_row": true,
                "disable_array_reorder": true,
                "disable_collapse": true,
                "enable_array_copy": false,
                "wb": {
                    "disable_panel": true,
					"disable_array_item_panel" : true,
					"disable_title" : true
                }
            },
            "propertyOrder": 200,
            "headerTemplate": "Controls",
            "type": "array"
        },
        "lightingControl": {
			"title": "Control",
            "properties": {
                "control": {
                    "type": "string",
                    "title": "Control",
                    "propertyOrder": 20,
                    "options": {
                        "grid_columns": 6
                    },
                    "watch": {
                        "channelsControls": "root.controls.channelsControls"
                    },
                    "enumSource": [
                        {
                            "source": "channelsControls",
                            "title": "{{item}}",
                            "value": "{{item}}"
                        }
                    ]
                },
				"condition": {
					"type": "string",
					"title": "Condition",
                    "propertyOrder": 30,
                    "enum": [
                        "equal",
                        "greater",
                        "less",
                        "change"
                    ],
                    "default": "equal",
                    "options": {
                        "grid_columns": 6,
						"enum_titles": [
						  "Equal",
						  "Greater",
						  "Less",
						  "Change"
						]
                    }
				},
				"value": {
					"type": "number",
					"title": "Value",
					"propertyOrder": 40,
					"options": {
						"grid_columns": 6
					}
				}
            },
			"required": [
				"control",
				"condition",
				"value"
			]
        },
		"astronomicalDayNightSensor": {
			"headerTemplate": "Astronomical sensor of day and night{{: |self.latitudeLongitude}}",
			"type": "object",
			"_format": "grid",
            "properties": {
				"useAstronomicalDayNightSensor": {
                    "type": "boolean",
					"title": "Use astronomical sensor of day and night",
					"description": "Enables the creation of a virtual device",
                    "default": false,
                    "propertyOrder": 20,
					"_format": "checkbox",
                    "options": {
						"grid_columns": 4,
                        "dependencies": {
                            "showLocations": false
                        }
					}
				},
                "latitudeLongitude": {
                    "type": "string",
                    "title": "Latitude, longitude",
					"description": "Copy the latitude and longitude of a point on Yandex maps",
                    "propertyOrder": 30,
                    "options": {
                        "grid_columns": 6
                    }
                }
			}
		}
    },
    "translations": {
        "ru": {
			"Lightings settings": "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Å–≤–µ—â–µ–Ω–∏—è",
			"Configuration of Lightings settings": "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å–≤–µ—Ç–∞ –∏ –¥–∞—Ç—á–∏–∫–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
			"Master switch": "–ú–∞—Å—Ç–µ—Ä –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å",
			"–êllows you to control subordinate light sources": "–ü–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ —Å–≤–µ—Ç–∞ –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç",
			"HW switch": "–í—ã–∫–ª—é—á–∞—Ç–µ–ª—å",
			"Hardware switch control": "–°–≤–æ–π—Å—Ç–≤–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–º",
			"Sub locations": "–ü–æ–¥—á–∏–Ω–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞",
			"Sources": "–ò—Å—Ç–æ—á–Ω–∏–∫–∏",
			"Controls": "–î–∞—Ç—á–∏–∫–∏",
			"Power off delay": "–ó–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è",
			"Auto power off": "–í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –¥–∞—Ç—á–∏–∫–∞–º",
			"Name": "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ",
			"Source": "–ò—Å—Ç–æ—á–Ω–∏–∫",
			"Control": "–î–∞—Ç—á–∏–∫",
			"Value": "–ó–Ω–∞—á–µ–Ω–∏–µ",
			"Brightness": "–Ø—Ä–∫–æ—Å—Ç—å",
			"row": "–°—Ç—Ä–æ–∫–∞",
			"Condition": "–£—Å–ª–æ–≤–∏–µ",
			"Equal": "–†–∞–≤–Ω–æ",
			"Greater": "–ë–æ–ª—å—à–µ",
			"Less": "–ú–µ–Ω—å—à–µ",
			"Change": "–ò–∑–º–µ–Ω–µ–Ω–∏–µ",
			"Illuminance sensor": "–î–∞—Ç—á–∏–∫ –æ—Å–≤–µ—â–µ–Ω–∏—è",
			"Locations": "–ú–µ—Å—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏",
			"Astronomical sensor of day and night{{: |self.latitudeLongitude}}": "–ê—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –¥–∞—Ç—á–∏–∫ –¥–Ω—è –∏ –Ω–æ—á–∏{{: |self.latitudeLongitude}}",
			"Use astronomical sensor of day and night": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –¥–∞—Ç—á–∏–∫",
			"Latitude, longitude": "–®–∏—Ä–æ—Ç–∞, –¥–æ–ª–≥–æ—Ç–∞",
			"Copy the latitude and longitude of a point on Yandex maps": "–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∏—Ä–æ—Ç—É –∏ –¥–æ–ª–≥–æ—Ç—É —Ç–æ—á–∫–∏ –Ω–∞ –Ø–Ω–¥–µ–∫—Å –∫–∞—Ä—Ç–∞—Ö",
			"Enables the creation of a virtual device": "–í–∫–ª—é—á–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"
		}
	}

}